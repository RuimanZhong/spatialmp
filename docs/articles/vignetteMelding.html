<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="spatialmp">
<title>vignetteMelding • spatialmp</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="vignetteMelding">
<meta property="og:description" content="spatialmp">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">spatialmp</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/vignetteMelding.html">vignetteMelding</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>vignetteMelding</h1>
            
      
      
      <div class="d-none name"><code>vignetteMelding.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">packages</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="st">'viridis'</span>,<span class="st">'rnaturalearthhires'</span>,<span class="st">'spatialmp'</span>,
              <span class="st">'sf'</span>,<span class="st">'INLA'</span>,<span class="st">'tidyverse'</span>,<span class="st">'spatialmp'</span><span class="op">)</span>

<span class="va">package.check</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">packages</span>, FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span>
  <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va">x</span> ,character.only <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">}</span>
  <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="op">(</span><span class="va">x</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/zpackages.html" class="external-link">.packages</a></span><span class="op">(</span><span class="op">)</span>  <span class="op">)</span> <span class="op">)</span> <span class="op">)</span><span class="op">{</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">x</span> ,character.only <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">}</span>
  <span class="op">}</span><span class="op">)</span>
<span class="co">#&gt; Loading required package: viridis</span>
<span class="co">#&gt; Loading required package: viridisLite</span>
<span class="co">#&gt; Warning: replacing previous import 'lifecycle::last_warnings' by</span>
<span class="co">#&gt; 'rlang::last_warnings' when loading 'tibble'</span>
<span class="co">#&gt; Warning: replacing previous import 'lifecycle::last_warnings' by</span>
<span class="co">#&gt; 'rlang::last_warnings' when loading 'pillar'</span>
<span class="co">#&gt; Loading required package: rnaturalearthhires</span>
<span class="co">#&gt; Loading required package: spatialmp</span>
<span class="co">#&gt; Loading required package: sf</span>
<span class="co">#&gt; Linking to GEOS 3.8.1, GDAL 3.2.1, PROJ 7.2.1; sf_use_s2() is TRUE</span>
<span class="co">#&gt; Loading required package: INLA</span>
<span class="co">#&gt; Warning: package 'INLA' was built under R version 4.1.1</span>
<span class="co">#&gt; Loading required package: Matrix</span>
<span class="co">#&gt; Loading required package: foreach</span>
<span class="co">#&gt; Loading required package: parallel</span>
<span class="co">#&gt; Loading required package: sp</span>
<span class="co">#&gt; This is INLA_21.11.22 built 2021-11-21 16:13:28 UTC.</span>
<span class="co">#&gt;  - See www.r-inla.org/contact-us for how to get help.</span>
<span class="co">#&gt;  - To enable PARDISO sparse library; see inla.pardiso()</span>
<span class="co">#&gt; Loading required package: tidyverse</span>
<span class="co">#&gt; Warning: replacing previous import 'lifecycle::last_warnings' by</span>
<span class="co">#&gt; 'rlang::last_warnings' when loading 'hms'</span>
<span class="co">#&gt; ── <span style="font-weight: bold;">Attaching packages</span> ─────────────────────────────────────── tidyverse 1.3.1 ──</span>
<span class="co">#&gt; <span style="color: #00BB00;">✓</span> <span style="color: #0000BB;">ggplot2</span> 3.3.5     <span style="color: #00BB00;">✓</span> <span style="color: #0000BB;">purrr  </span> 0.3.4</span>
<span class="co">#&gt; <span style="color: #00BB00;">✓</span> <span style="color: #0000BB;">tibble </span> 3.1.4     <span style="color: #00BB00;">✓</span> <span style="color: #0000BB;">dplyr  </span> 1.0.7</span>
<span class="co">#&gt; <span style="color: #00BB00;">✓</span> <span style="color: #0000BB;">tidyr  </span> 1.1.3     <span style="color: #00BB00;">✓</span> <span style="color: #0000BB;">stringr</span> 1.4.0</span>
<span class="co">#&gt; <span style="color: #00BB00;">✓</span> <span style="color: #0000BB;">readr  </span> 2.0.1     <span style="color: #00BB00;">✓</span> <span style="color: #0000BB;">forcats</span> 0.5.1</span>
<span class="co">#&gt; ── <span style="font-weight: bold;">Conflicts</span> ────────────────────────────────────────── tidyverse_conflicts() ──</span>
<span class="co">#&gt; <span style="color: #BB0000;">x</span> <span style="color: #0000BB;">purrr</span>::<span style="color: #00BB00;">accumulate()</span> masks <span style="color: #0000BB;">foreach</span>::accumulate()</span>
<span class="co">#&gt; <span style="color: #BB0000;">x</span> <span style="color: #0000BB;">tidyr</span>::<span style="color: #00BB00;">expand()</span>     masks <span style="color: #0000BB;">Matrix</span>::expand()</span>
<span class="co">#&gt; <span style="color: #BB0000;">x</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">filter()</span>     masks <span style="color: #0000BB;">stats</span>::filter()</span>
<span class="co">#&gt; <span style="color: #BB0000;">x</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">lag()</span>        masks <span style="color: #0000BB;">stats</span>::lag()</span>
<span class="co">#&gt; <span style="color: #BB0000;">x</span> <span style="color: #0000BB;">tidyr</span>::<span style="color: #00BB00;">pack()</span>       masks <span style="color: #0000BB;">Matrix</span>::pack()</span>
<span class="co">#&gt; <span style="color: #BB0000;">x</span> <span style="color: #0000BB;">tidyr</span>::<span style="color: #00BB00;">unpack()</span>     masks <span style="color: #0000BB;">Matrix</span>::unpack()</span>
<span class="co">#&gt; <span style="color: #BB0000;">x</span> <span style="color: #0000BB;">purrr</span>::<span style="color: #00BB00;">when()</span>       masks <span style="color: #0000BB;">foreach</span>::when()</span>
<span class="fu">theme_set</span><span class="op">(</span><span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>ggplot2.continuous.colour<span class="op">=</span><span class="st">"viridis"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>ggplot2.continuous.fill <span class="op">=</span> <span class="st">"viridis"</span><span class="op">)</span></code></pre></div>
<div class="section level2">
<h2 id="specifying-the-arguments-of-fnpredictmelding">Specifying the arguments of <code>fnPredictMelding()</code><a class="anchor" aria-label="anchor" href="#specifying-the-arguments-of-fnpredictmelding"></a>
</h2>
<p>We need to specify the observed point and areal data that will be used for estimation. These are <code>sf</code> objects called <code>depoint</code> with the point data and <code>dearea</code> with the areal data.</p>
<p>Then, we need to specify the locations or areas where we want to get predictions. Depending on where we want to predict, we would need to specify <code>sf</code> objects <code>dppoint</code> for a set of points and <code>dparea</code> for a set of areas.</p>
<p><code>dppoint</code> can be an <code>sf</code> object containing a few points or a dense set of regular points within the study region representing a continuous surface (<code>dpcontsurface</code>).</p>
<p>We also need to specify an <code>sf</code> object the boundary of the region of study, <code>boundaryregion</code>.</p>
<p>Note that all objects need to be <code>sf</code> objects and have the same projection. Therefore, if we have <code>raster</code> or <code>sp</code> data, we need to transform them to <code>sf</code> to be able to use the package.</p>
<div class="section level3">
<h3 id="specifying-the-boundary-region">Specifying the boundary region<a class="anchor" aria-label="anchor" href="#specifying-the-boundary-region"></a>
</h3>
<p>In this example, we specify the projection as 4326 or WSG84 (latitude and longitude).</p>
<p>The region of study is UK. We obtain the boundary of the region of study with the <code>rgeoboundaries</code> package and transform it to the chosen projection.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># CRS projection</span>
<span class="va">crsproj</span> <span class="op">&lt;-</span> <span class="fl">4326</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gitlab.com/dickoa/rgeoboundaries" class="external-link">rgeoboundaries</a></span><span class="op">)</span>
<span class="co">#&gt; Registered S3 method overwritten by 'hoardr':</span>
<span class="co">#&gt;   method           from</span>
<span class="co">#&gt;   print.cache_info httr</span>
<span class="va">boundaryregion</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rgeoboundaries/man/geoboundaries.html" class="external-link">geoboundaries</a></span><span class="op">(</span><span class="st">"United Kingdom"</span><span class="op">)</span>
<span class="va">boundaryregion</span> <span class="op">&lt;-</span> <span class="fu">st_transform</span><span class="op">(</span><span class="va">boundaryregion</span> , <span class="va">crsproj</span><span class="op">)</span> 

<span class="fu">ggplot</span><span class="op">(</span><span class="va">boundaryregion</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_sf</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="vignetteMelding_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="specifying-the-observed-point-and-areal-data-for-estimation">Specifying the observed point and areal data for estimation<a class="anchor" aria-label="anchor" href="#specifying-the-observed-point-and-areal-data-for-estimation"></a>
</h3>
<div class="section level4">
<h4 id="point-data-for-estimation">Point data for estimation<a class="anchor" aria-label="anchor" href="#point-data-for-estimation"></a>
</h4>
<p>The observed point data <code>depoint</code> is an <code>sf</code> object with three columns, namely, <code>x</code> and <code>y</code> with the coordinates of the locations, and <code>value</code> with the observed PM2.5 values at the locations.</p>
<p>In our example, point data are in a <code>.csv</code> file. After reading the data frame, we convert it to an <code>sf</code> object and specify the chosen projection. You can download the data on <a href="https://github.com/RuimanZhong/SpatialM" class="external-link uri">https://github.com/RuimanZhong/SpatialM</a></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">depoint</span> <span class="op">&lt;-</span> <span class="va">depoint</span> <span class="op">%&gt;%</span> <span class="fu">st_as_sf</span><span class="op">(</span>coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span>, dim <span class="op">=</span> <span class="st">"XY"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">st_set_crs</span><span class="op">(</span><span class="va">crsproj</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">st_cast</span><span class="op">(</span><span class="st">"MULTIPOINT"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">depoint</span><span class="op">)</span>
<span class="co">#&gt; Simple feature collection with 6 features and 1 field</span>
<span class="co">#&gt; Geometry type: MULTIPOINT</span>
<span class="co">#&gt; Dimension:     XY</span>
<span class="co">#&gt; Bounding box:  xmin: -5.928833 ymin: 51.07479 xmax: -1.829999 ymax: 57.15736</span>
<span class="co">#&gt; Geodetic CRS:  WGS 84</span>
<span class="co">#&gt;       value                       geometry</span>
<span class="co">#&gt; 1  5.371804 MULTIPOINT ((-2.094278 57.1...</span>
<span class="co">#&gt; 2  2.549784 MULTIPOINT ((-3.2429 55.792...</span>
<span class="co">#&gt; 3 10.701091 MULTIPOINT ((-4.041924 51.0...</span>
<span class="co">#&gt; 4  9.554778 MULTIPOINT ((-5.928833 54.5...</span>
<span class="co">#&gt; 5 13.283601 MULTIPOINT ((-1.875024 52.4...</span>
<span class="co">#&gt; 6 10.227034 MULTIPOINT ((-1.829999 52.4...</span>
<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">boundaryregion</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_sf</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
<span class="fu">geom_sf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">depoint</span>, <span class="fu">aes</span><span class="op">(</span>col <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="vignetteMelding_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="areal-data-for-estimation">Areal data for estimation<a class="anchor" aria-label="anchor" href="#areal-data-for-estimation"></a>
</h4>
<p>The areal data <code>dearea</code> is an <code>sf</code> object with columns XXXX</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">boundaryregion</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_sf</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
<span class="fu">geom_sf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">dearea</span>, <span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="vignetteMelding_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
</div>
<div class="section level3">
<h3 id="specifying-point-areal-and-continuous-surface-data-for-prediction">Specifying point, areal and continuous surface data for prediction<a class="anchor" aria-label="anchor" href="#specifying-point-areal-and-continuous-surface-data-for-prediction"></a>
</h3>
<div class="section level4">
<h4 id="point-data-for-prediction">Point data for prediction<a class="anchor" aria-label="anchor" href="#point-data-for-prediction"></a>
</h4>
<p>Point data for prediction <code>dppoint</code> is an <code>sf</code> object with columns XXX.</p>
<p>In this example we use the same point data for prediction and estimation.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dppoint</span> <span class="op">&lt;-</span> <span class="va">depoint</span>


<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">boundaryregion</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_sf</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
<span class="fu">geom_sf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">dppoint</span><span class="op">)</span></code></pre></div>
<p><img src="vignetteMelding_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="areal-data-for-prediction">Areal data for prediction<a class="anchor" aria-label="anchor" href="#areal-data-for-prediction"></a>
</h4>
<p>Areal data for prediction <code>dparea</code> is an <code>sf</code> object with columns XXX.</p>
<p>In this example we use the same areal data for prediction and estimation.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dparea</span> <span class="op">&lt;-</span> <span class="va">dearea</span>


<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">boundaryregion</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_sf</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
<span class="fu">geom_sf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">dparea</span><span class="op">)</span></code></pre></div>
<p><img src="vignetteMelding_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="continuous-surface-for-prediciton">Continuous surface for prediciton<a class="anchor" aria-label="anchor" href="#continuous-surface-for-prediciton"></a>
</h4>
<p>If we wish to predict in a continuous surface, we need to provide a dense grid of points within the region of study. We can do that by creating a bounding box of the region of study and using <code><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid()</a></code> to create a grid of points within the boundary.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Bounding box of the boundary of the region of study</span>
<span class="va">bb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="fu">st_geometry</span><span class="op">(</span><span class="va">boundaryregion</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">bbox</span><span class="op">)</span>

<span class="co"># Grid</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">bb</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="fl">1</span>, <span class="va">bb</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">+</span> <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">bb</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="fl">1</span>, <span class="va">bb</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">+</span> <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>
<span class="va">coop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span>
<span class="va">coop_sf</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="va">coop</span>, coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Var1'</span>,<span class="st">'Var2'</span><span class="op">)</span>, crs <span class="op">=</span> <span class="va">crsproj</span><span class="op">)</span>

<span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu">geom_sf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">coop_sf</span><span class="op">)</span></code></pre></div>
<p><img src="vignetteMelding_files/figure-html/unnamed-chunk-9-1.png" width="700"> The next step is to remove the point outside of the boundary. Thus, the leaf points are just our target points, which will be <code>dppoint</code> in <code><a href="../reference/fnPredictMelding.html">fnPredictMelding()</a></code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Transform matrix data to sf objet</span>
<span class="va">dpcontsurface</span> <span class="op">&lt;-</span> <span class="va">coop_sf</span> <span class="op">%&gt;%</span> <span class="fu">st_join</span><span class="op">(</span><span class="va">boundaryregion</span>, left <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
  
<span class="fu">ggplot</span><span class="op">(</span><span class="va">dpcontsurface</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_sf</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="vignetteMelding_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">boundaryregion</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_sf</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
<span class="fu">geom_sf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">dpcontsurface</span><span class="op">)</span></code></pre></div>
<p><img src="vignetteMelding_files/figure-html/unnamed-chunk-10-2.png" width="700"></p>
</div>
</div>
<div class="section level3">
<h3 id="melding-approach-with-fnpredictmelding">Melding approach with <code>fnPredictMelding()</code><a class="anchor" aria-label="anchor" href="#melding-approach-with-fnpredictmelding"></a>
</h3>
<p>Here we show how to make prediction using the melding approach using point data for estimation only, areal data for estimation only, and both point and areal data for estimation combined. Predictions are obtained with the <code><a href="../reference/fnPredictMelding.html">fnPredictMelding()</a></code> function.</p>
<p>The returned value of <code><a href="../reference/fnPredictMelding.html">fnPredictMelding()</a></code> is a list with two objects. points and areas EXPLAIN MORE</p>
<p>The melding approach method is based on SPDE approach, which needs to uses a triangulated mesh and priors for the variance and range of the spatial random effect before make predictions. It is recommended the user carefully chooses both the mesh and the priors. The package provides a function <code><a href="../reference/fnCreateMesh.html">fnCreateMesh()</a></code> to help users create their own mesh, and also has functionality to compute a default mesh and priors.</p>
<p>The arguments of <code><a href="../reference/fnCreateMesh.html">fnCreateMesh()</a></code> are <code>depoint</code> <code>boundaryregion</code>. <code>boundaryregion</code> is mandatory. It is the boundary of the estimated Gaussian random field. Our mesh will be created only within boundary. And the estimation and prediction will be done based on the created mesh, which will not exist over <code>boundaryregion</code>. In other words, the input point/areal data and the target points or areas locations have to be within the <code>boundaryregion</code>. We are not allowed the estimation and the prediction locations outside the <code>boundaryregion</code>.</p>
<p><code>depoint</code> is not mandatory. IF the input point data is accessible, the locations of the points will be the used as initial triangulation nodes of our created mesh. But if only the <code>boundaryregion</code> is provided, the function will be able to generate a mesh as well.</p>
<p>The two parameters <code>priorspdesigma</code> and <code>priorspderange</code> are used to create a SPDE with Penalized Complexity priors (PC priors), which is proposed by Simpson et al.(2017). PC priors are defined by probability statements about the parameters <span class="math inline">\(\sigma\)</span> and <span class="math inline">\(\rho\)</span>. <span class="math inline">\(\sigma\)</span> is the marginal standard deviation of the random field and <span class="math inline">\(\rho\)</span> is the spatial range of the field. If users want to set PC priors for their random fields, <code>priorspdesigma</code> and <code>priorspderange</code> are supposed to be input. Both two parameters are 2 length vectors. The first element of <code>priorspdesigma</code>is the value of the <span class="math inline">\(\sigma\)</span> and the second element is the probability of <span class="math inline">\(\sigma\)</span> <strong>larger</strong> than the first element. That is, <span class="math display">\[
P(σ &gt; σ_0)=p_σ
\]</span> Similarly, the first element for <code>priorspderange</code> is the value of the <span class="math inline">\(\rho\)</span> and the second element is the probability of <span class="math inline">\(\sigma\)</span> <strong>less</strong> than the first element.</p>
<p><span class="math display">\[
P(ρ &lt; ρ_0)=p_ρ
\]</span></p>
<p>Thus, the two elements of <code>priorspdesigma</code> and <code>priorspderange</code> are positive and the second elements (probabilities) are also less than 1.</p>
<div class="section level4">
<h4 id="prediction-using-point-data">Prediction using point data<a class="anchor" aria-label="anchor" href="#prediction-using-point-data"></a>
</h4>
<p>Then we call the function to predict. The predicted mean and predicted interval are obtained.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Create mesh</span>
<span class="va">mesh</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fnCreateMesh.html">fnCreateMesh</a></span><span class="op">(</span><span class="va">depoint</span>, <span class="va">boundaryregion</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mesh</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu">st_coordinates</span><span class="op">(</span><span class="va">depoint</span><span class="op">)</span><span class="op">[</span> , <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, col <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="vignetteMelding_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">respre</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fnPredictMelding.html">fnPredictMelding</a></span><span class="op">(</span>depoint <span class="op">=</span> <span class="va">depoint</span>, dearea <span class="op">=</span> <span class="cn">NULL</span>, dppoint <span class="op">=</span> <span class="va">dppoint</span>, dparea <span class="op">=</span> <span class="cn">NULL</span>, boundaryregion <span class="op">=</span> <span class="va">boundaryregion</span>, mesh <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>
<span class="co">#&gt; Creating stack</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">respre</span><span class="op">)</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; Simple feature collection with 74 features and 4 fields</span>
<span class="co">#&gt; Geometry type: MULTIPOINT</span>
<span class="co">#&gt; Dimension:     XY</span>
<span class="co">#&gt; Bounding box:  xmin: -7.331179 ymin: 50.37167 xmax: 1.301976 ymax: 57.15736</span>
<span class="co">#&gt; Geodetic CRS:  WGS 84</span>
<span class="co">#&gt; First 10 features:</span>
<span class="co">#&gt;        value                       geometry pred_mean   pred_ll   pred_ul</span>
<span class="co">#&gt; 1   5.371804 MULTIPOINT ((-2.094278 57.1...  6.550580  3.914498  8.992801</span>
<span class="co">#&gt; 2   2.549784 MULTIPOINT ((-3.2429 55.792...  6.914991  5.100334  8.547129</span>
<span class="co">#&gt; 3  10.701091 MULTIPOINT ((-4.041924 51.0... 10.392816  8.943155 11.841320</span>
<span class="co">#&gt; 4   9.554778 MULTIPOINT ((-5.928833 54.5...  9.865655  7.970188 11.838501</span>
<span class="co">#&gt; 5  13.283601 MULTIPOINT ((-1.875024 52.4... 10.946536  9.987447 11.995083</span>
<span class="co">#&gt; 6  10.227034 MULTIPOINT ((-1.829999 52.4... 10.933105 10.015721 11.910612</span>
<span class="co">#&gt; 7  11.189479 MULTIPOINT ((-1.830583 52.5... 10.953393 10.031297 11.954679</span>
<span class="co">#&gt; 8  12.487220 MULTIPOINT ((-1.830861 52.5... 10.953467 10.031125 11.955204</span>
<span class="co">#&gt; 9   7.837424 MULTIPOINT ((-3.007175 53.8...  9.371486  8.055029 10.583591</span>
<span class="co">#&gt; 10 11.660835 MULTIPOINT ((-2.584482 51.4... 10.582036  9.316051 11.818658</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt; NULL</span>
<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">boundaryregion</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_sf</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_sf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">respre</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="fu">aes</span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">geometry</span>, color <span class="op">=</span> <span class="va">pred_mean</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Average PM 2.5  Level 2016, UK"</span>, fill <span class="op">=</span> <span class="st">"PM 2.5"</span><span class="op">)</span></code></pre></div>
<p><img src="vignetteMelding_files/figure-html/unnamed-chunk-11-2.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="prediction-using-areal-data">Prediction using areal data<a class="anchor" aria-label="anchor" href="#prediction-using-areal-data"></a>
</h4>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mesh</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fnCreateMesh.html">fnCreateMesh</a></span><span class="op">(</span><span class="cn">NULL</span>, <span class="va">boundaryregion</span><span class="op">)</span>
<span class="va">respre</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fnPredictMelding.html">fnPredictMelding</a></span><span class="op">(</span>depoint <span class="op">=</span>  <span class="cn">NULL</span>, dearea <span class="op">=</span> <span class="va">dearea</span>, dppoint <span class="op">=</span> <span class="cn">NULL</span>, dparea <span class="op">=</span> <span class="va">dparea</span>, boundaryregion <span class="op">=</span> <span class="va">boundaryregion</span>,  mesh <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>
<span class="co">#&gt; Creating stack</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">respre</span><span class="op">)</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; NULL</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt; Simple feature collection with 369 features and 4 fields</span>
<span class="co">#&gt; Geometry type: POLYGON</span>
<span class="co">#&gt; Dimension:     XY</span>
<span class="co">#&gt; Bounding box:  xmin: -8.05 ymin: 50.05 xmax: 1.85 ymax: 60.55</span>
<span class="co">#&gt; Geodetic CRS:  GCS_WGS_84_with_axis_order_normalized_for_visualization</span>
<span class="co">#&gt; First 10 features:</span>
<span class="co">#&gt;       value                       geometry pred_mean   pred_ll  pred_ul</span>
<span class="co">#&gt; 1  1.304525 POLYGON ((-1.45 60.55, -1.1...  1.529532 0.8544293 2.205631</span>
<span class="co">#&gt; 2  1.471671 POLYGON ((-1.45 60.25, -1.1...  1.722975 1.0865609 2.359767</span>
<span class="co">#&gt; 3  1.950916 POLYGON ((-3.55 59.05, -3.2...  2.028445 1.4644438 2.592719</span>
<span class="co">#&gt; 4  1.784966 POLYGON ((-5.05 58.75, -4.7...  1.773035 1.2527676 2.293541</span>
<span class="co">#&gt; 5  2.007207 POLYGON ((-3.85 58.75, -3.5...  2.012323 1.5787840 2.445551</span>
<span class="co">#&gt; 6  2.086011 POLYGON ((-3.55 58.75, -3.2...  2.116046 1.6965471 2.535770</span>
<span class="co">#&gt; 7  2.416477 POLYGON ((-3.25 58.75, -2.9...  2.214291 1.7063267 2.723533</span>
<span class="co">#&gt; 8  1.528081 POLYGON ((-6.85 58.45, -6.5...  1.576471 1.0805698 2.072329</span>
<span class="co">#&gt; 9  1.534573 POLYGON ((-6.55 58.45, -6.2...  1.584396 1.0346244 2.133714</span>
<span class="co">#&gt; 10 1.742093 POLYGON ((-5.05 58.45, -4.7...  1.775110 1.3164423 2.233775</span>
<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">boundaryregion</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_sf</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
   <span class="fu">geom_sf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">respre</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, <span class="fu">aes</span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">geometry</span>, fill <span class="op">=</span> <span class="va">pred_mean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
   <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Average PM 2.5  Level 2016, UK"</span>, fill <span class="op">=</span> <span class="st">"PM 2.5"</span><span class="op">)</span></code></pre></div>
<p><img src="vignetteMelding_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="prediction-using-point-and-areal-data">Prediction using point and areal data<a class="anchor" aria-label="anchor" href="#prediction-using-point-and-areal-data"></a>
</h4>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mesh</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fnCreateMesh.html">fnCreateMesh</a></span><span class="op">(</span><span class="va">depoint</span>, <span class="va">boundaryregion</span><span class="op">)</span>
<span class="va">respre</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fnPredictMelding.html">fnPredictMelding</a></span><span class="op">(</span>depoint <span class="op">=</span>  <span class="va">depoint</span>, dearea <span class="op">=</span> <span class="va">dearea</span>, dppoint <span class="op">=</span> <span class="va">dppoint</span>, dparea <span class="op">=</span> <span class="va">dparea</span>, boundaryregion <span class="op">=</span> <span class="va">boundaryregion</span>,  mesh <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>
<span class="co">#&gt; Creating stack</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">respre</span><span class="op">)</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; Simple feature collection with 74 features and 4 fields</span>
<span class="co">#&gt; Geometry type: MULTIPOINT</span>
<span class="co">#&gt; Dimension:     XY</span>
<span class="co">#&gt; Bounding box:  xmin: -7.331179 ymin: 50.37167 xmax: 1.301976 ymax: 57.15736</span>
<span class="co">#&gt; Geodetic CRS:  WGS 84</span>
<span class="co">#&gt; First 10 features:</span>
<span class="co">#&gt;        value                       geometry pred_mean   pred_ll   pred_ul</span>
<span class="co">#&gt; 1   5.371804 MULTIPOINT ((-2.094278 57.1...  4.007241  3.077103  4.946125</span>
<span class="co">#&gt; 2   2.549784 MULTIPOINT ((-3.2429 55.792...  4.680830  3.947745  5.412652</span>
<span class="co">#&gt; 3  10.701091 MULTIPOINT ((-4.041924 51.0...  7.250230  6.478988  8.038789</span>
<span class="co">#&gt; 4   9.554778 MULTIPOINT ((-5.928833 54.5...  4.892116  4.076182  5.744236</span>
<span class="co">#&gt; 5  13.283601 MULTIPOINT ((-1.875024 52.4... 11.080264 10.433206 11.754357</span>
<span class="co">#&gt; 6  10.227034 MULTIPOINT ((-1.829999 52.4... 11.070072 10.481435 11.676665</span>
<span class="co">#&gt; 7  11.189479 MULTIPOINT ((-1.830583 52.5... 11.110515 10.506651 11.736701</span>
<span class="co">#&gt; 8  12.487220 MULTIPOINT ((-1.830861 52.5... 11.110604 10.506414 11.737193</span>
<span class="co">#&gt; 9   7.837424 MULTIPOINT ((-3.007175 53.8...  7.634217  6.869458  8.422150</span>
<span class="co">#&gt; 10 11.660835 MULTIPOINT ((-2.584482 51.4...  9.670917  9.012032 10.359395</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt; Simple feature collection with 369 features and 4 fields</span>
<span class="co">#&gt; Geometry type: POLYGON</span>
<span class="co">#&gt; Dimension:     XY</span>
<span class="co">#&gt; Bounding box:  xmin: -8.05 ymin: 50.05 xmax: 1.85 ymax: 60.55</span>
<span class="co">#&gt; Geodetic CRS:  GCS_WGS_84_with_axis_order_normalized_for_visualization</span>
<span class="co">#&gt; First 10 features:</span>
<span class="co">#&gt;       value                       geometry pred_mean   pred_ll  pred_ul</span>
<span class="co">#&gt; 1  1.304525 POLYGON ((-1.45 60.55, -1.1...  2.342074 0.6416859 4.035639</span>
<span class="co">#&gt; 2  1.471671 POLYGON ((-1.45 60.25, -1.1...  2.525131 0.9461201 4.097728</span>
<span class="co">#&gt; 3  1.950916 POLYGON ((-3.55 59.05, -3.2...  2.119559 0.9107062 3.335055</span>
<span class="co">#&gt; 4  1.784966 POLYGON ((-5.05 58.75, -4.7...  1.825165 0.7072667 2.958112</span>
<span class="co">#&gt; 5  2.007207 POLYGON ((-3.85 58.75, -3.5...  2.049390 1.1200045 2.982176</span>
<span class="co">#&gt; 6  2.086011 POLYGON ((-3.55 58.75, -3.2...  2.138530 1.1890642 3.088845</span>
<span class="co">#&gt; 7  2.416477 POLYGON ((-3.25 58.75, -2.9...  2.252132 1.1686884 3.334321</span>
<span class="co">#&gt; 8  1.528081 POLYGON ((-6.85 58.45, -6.5...  1.850579 0.6698023 3.026604</span>
<span class="co">#&gt; 9  1.534573 POLYGON ((-6.55 58.45, -6.2...  1.720579 0.5126409 2.919338</span>
<span class="co">#&gt; 10 1.742093 POLYGON ((-5.05 58.45, -4.7...  1.806396 0.7936027 2.827475</span>
<span class="co"># point data</span>
<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">boundaryregion</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_sf</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_sf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">respre</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="fu">aes</span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">geometry</span>, color <span class="op">=</span> <span class="va">pred_mean</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Average PM 2.5  Level 2016, UK"</span>, fill <span class="op">=</span> <span class="st">"PM 2.5"</span><span class="op">)</span></code></pre></div>
<p><img src="vignetteMelding_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># areal data</span>
<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">boundaryregion</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_sf</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
   <span class="fu">geom_sf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">respre</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, <span class="fu">aes</span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">geometry</span>, fill <span class="op">=</span> <span class="va">pred_mean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
   <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Average PM 2.5  Level 2016, UK"</span>, fill <span class="op">=</span> <span class="st">"PM 2.5"</span><span class="op">)</span></code></pre></div>
<p><img src="vignetteMelding_files/figure-html/unnamed-chunk-13-2.png" width="700"></p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by First Last.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
